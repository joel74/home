#!/usr/bin/env zsh

function link() {
    if [[ -e $2 || -L $2 ]] then
        unlink $2
    fi

    if [[ -e $1 ]] then
        echo link $2 -\> $1
        ln -s $1 $2
    fi
}

function copy() {
    if [[ -e $2 || -L $2 ]] then
        unlink $2
    fi

    if [[ -e $1 ]] then
        echo copy $1 -\> $2
        cp -f $1 $2
    fi
}

[[ -z "$JACHYMKO" ]] && JACHYMKO=$(echo `dirname $0`(:A))
[[ -z "$prefix"   ]] && prefix=~

if [[ ! -e $prefix/.jachymko ]]; then
    link $JACHYMKO $prefix/.jachymko
fi

# gitconfig is copied because uname/install-jachymko scripts modify it
copy $JACHYMKO/gitconfig      $prefix/.gitconfig
link $JACHYMKO/gitignore      $prefix/.gitignore
link $JACHYMKO/ircrc          $prefix/.ircrc
link $JACHYMKO/tmux/tmux.conf $prefix/.tmux.conf
link $JACHYMKO/vim            $prefix/.vim
link $JACHYMKO/vim/vimrc      $prefix/.vimrc
link $JACHYMKO/vim/gvimrc     $prefix/.gvimrc
link $JACHYMKO/zlogin         $prefix/.zlogin
link $JACHYMKO/zshenv         $prefix/.zshenv
link $JACHYMKO/zshrc          $prefix/.zshrc

if [[ -x "$JACHYMKO/`uname`/install-jachymko" ]]; then
    "$JACHYMKO/`uname`/install-jachymko"
fi
